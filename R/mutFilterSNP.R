#'
#' @description Filter SNP variants based on VAF and clinical significance
#'
#' @param maf An MAF object, generated by \code{\link{vcfToMAF}} function
#' @param VAFcutoff Threshold of VAF value, variants with VAF lower than cutoff
#' will be filtered. Default: 0.05
#' 
#' @return An MAF object after SNP filtering

mutFilterSNP <- function(maf, VAFcutoff = 0.05) {
  
  ## create a vector to store the indices variants will be discarded
  discard <- c()
  for (i in 1:nrow(maf)) {
    if (maf[i, 'VAF'] < VAFcutoff) {
      if (length(grep('athogenic', maf[i, 'CLIN_SIG'])) == 0){
        discard <- c(discard, i)
      }
    }
  }
  
  if (is.null(discard)){
    message('Note: no mutation filtered.')
    return(maf)
  }else {
    maf_filtered <- maf[-discard, ]
  }
  
  if (nrow(maf_filtered) == 0) {
    
    message('Note: no mutation left after SNP filtering')
    return(maf_filtered)
  } else {
    rownames(maf_filtered) <- 1:nrow(maf_filtered)
    return(maf_filtered)
  }
}
