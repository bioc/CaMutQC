#' mutFilterNormalDP
#' @description Filter dbsnp/non-dbsnp variants based on their normal depth
#'
#' @param maf An MAF data frame, generated by \code{\link{vcfToMAF}} function.
#'
#' @return An MAF data frame after filtration for normal DP.
#'
#' @export mutFilterNormalDP
#' @examples
#' maf <- vcfToMAF(system.file("extdata", "GC48-2_mutect2.vep.vcf",
#' package = "CaMutQC"))
#' mafF <- mutFilterNormalDP(maf)


mutFilterNormalDP <- function(maf) {
  if (!('Existing_variation' %in% colnames(maf))) {
    stop('No annotation from existing database detected.')
  }

  # build a vector to store discarded variants
  discard <- c()

  for (i in seq_len(nrow(maf))) {
    # variants in dbsnp
    if(length(grep('rs', maf[i, 'Existing_variation']))) {
      if(maf$n_depth[i] < 19) {
        discard <- c(discard, i)
      }

    # variants not in dbsnp
    }else if (maf$n_depth[i] < 8) {
      discard <- c(discard, i)
    }
 }

  # add tag
  maf[discard, 'CaTag'] <- paste0(maf[discard, 'CaTag'], 'N')
  return(maf)
}

